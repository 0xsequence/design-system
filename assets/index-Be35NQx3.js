import{r as s}from"./index-CFahbR6w.js";import{c as m,u as j}from"./index-Dh_-W7HB.js";import{P as y,d as M}from"./index-Ce67QAn2.js";import{u as w}from"./index-DL-473Cy.js";import{u as x}from"./index-DbXBaF7s.js";import{u as z}from"./index-CPGYtN0H.js";import{j as b}from"./jsx-runtime-D_zvdyIk.js";import{h as H}from"./index-CHC4nfYS.js";var X="DismissableLayer",p="dismissableLayer.update",Y="dismissableLayer.pointerDownOutside",q="dismissableLayer.focusOutside",R,T=s.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),B=s.forwardRef((n,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:t,onFocusOutside:o,onInteractOutside:l,onDismiss:u,...v}=n,c=s.useContext(T),[d,N]=s.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,F]=s.useState({}),W=w(e,a=>N(a)),P=Array.from(c.layers),[I]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),_=P.indexOf(I),D=d?P.indexOf(d):-1,k=c.layersWithOutsidePointerEventsDisabled.size>0,L=D>=_,U=J(a=>{const E=a.target,O=[...c.branches].some(h=>h.contains(E));!L||O||(t==null||t(a),l==null||l(a),a.defaultPrevented||u==null||u())},f),C=K(a=>{const E=a.target;[...c.branches].some(h=>h.contains(E))||(o==null||o(a),l==null||l(a),a.defaultPrevented||u==null||u())},f);return z(a=>{D===c.layers.size-1&&(i==null||i(a),!a.defaultPrevented&&u&&(a.preventDefault(),u()))},f),s.useEffect(()=>{if(d)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(R=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),g(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=R)}},[d,f,r,c]),s.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),g())},[d,c]),s.useEffect(()=>{const a=()=>F({});return document.addEventListener(p,a),()=>document.removeEventListener(p,a)},[]),b.jsx(y.div,{...v,ref:W,style:{pointerEvents:k?L?"auto":"none":void 0,...n.style},onFocusCapture:m(n.onFocusCapture,C.onFocusCapture),onBlurCapture:m(n.onBlurCapture,C.onBlurCapture),onPointerDownCapture:m(n.onPointerDownCapture,U.onPointerDownCapture)})});B.displayName=X;var G="DismissableLayerBranch",S=s.forwardRef((n,e)=>{const r=s.useContext(T),i=s.useRef(null),t=w(e,i);return s.useEffect(()=>{const o=i.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),b.jsx(y.div,{...n,ref:t})});S.displayName=G;function J(n,e=globalThis==null?void 0:globalThis.document){const r=x(n),i=s.useRef(!1),t=s.useRef(()=>{});return s.useEffect(()=>{const o=u=>{if(u.target&&!i.current){let v=function(){A(Y,r,c,{discrete:!0})};const c={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",t.current),t.current=v,e.addEventListener("click",t.current,{once:!0})):v()}else e.removeEventListener("click",t.current);i.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",t.current)}},[e,r]),{onPointerDownCapture:()=>i.current=!0}}function K(n,e=globalThis==null?void 0:globalThis.document){const r=x(n),i=s.useRef(!1);return s.useEffect(()=>{const t=o=>{o.target&&!i.current&&A(q,r,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",t),()=>e.removeEventListener("focusin",t)},[e,r]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function g(){const n=new CustomEvent(p);document.dispatchEvent(n)}function A(n,e,r,{discrete:i}){const t=r.originalEvent.target,o=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:r});e&&t.addEventListener(n,e,{once:!0}),i?M(t,o):t.dispatchEvent(o)}var oe=B,ae=S,Q="Portal",V=s.forwardRef((n,e)=>{var u;const{container:r,...i}=n,[t,o]=s.useState(!1);j(()=>o(!0),[]);const l=r||t&&((u=globalThis==null?void 0:globalThis.document)==null?void 0:u.body);return l?H.createPortal(b.jsx(y.div,{...i,ref:e}),l):null});V.displayName=Q;export{ae as B,B as D,V as P,oe as R};
